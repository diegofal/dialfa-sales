generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fieldReference"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model EFMigrationsHistory {
  MigrationId    String @id(map: "PK___EFMigrationsHistory") @db.VarChar(150)
  ProductVersion String @db.VarChar(32)

  @@map("__EFMigrationsHistory")
}

model account_movements {
  id                 BigInt           @id(map: "PK_account_movements") @default(autoincrement())
  client_id          BigInt
  movement_type      Int
  amount             Decimal          @db.Decimal
  payment_method_id  Int?
  movement_date      DateTime         @db.Timestamptz(6)
  reference_document String?
  check_number       String?
  check_due_date     DateTime?        @db.Timestamptz(6)
  bank_name          String?
  notes              String?
  created_at         DateTime         @db.Timestamptz(6)
  updated_at         DateTime         @db.Timestamptz(6)
  deleted_at         DateTime?        @db.Timestamptz(6)
  created_by         Int?
  updated_by         Int?
  clients            clients          @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_account_movements__clients_client_id")
  payment_methods    payment_methods? @relation(fields: [payment_method_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "f_k_account_movements__payment_methods_payment_method_id")

  @@index([client_id], map: "IX_account_movements_client_id")
  @@index([payment_method_id], map: "IX_account_movements_payment_method_id")
}

model articles {
  id                   BigInt                 @id(map: "PK_articles") @default(autoincrement())
  code                 String                 @db.VarChar(50)
  description          String                 @db.VarChar(500)
  category_id          BigInt
  unit_price           Decimal                @db.Decimal(18, 4)
  stock                Decimal                @db.Decimal(12, 3)
  location             String?                @db.VarChar(200)
  is_discontinued      Boolean                @default(false)
  notes                String?
  created_at           DateTime               @db.Timestamptz(6)
  updated_at           DateTime               @db.Timestamptz(6)
  deleted_at           DateTime?              @db.Timestamptz(6)
  created_by           Int?
  updated_by           Int?
  cost_price           Decimal?               @db.Decimal(18, 4)
  display_order        String?                @db.VarChar(20)
  historical_price1    Decimal?               @db.Decimal(18, 2)
  series               Int?
  size                 String?                @db.VarChar(100)
  supplier_id          Int?
  thickness            String?                @db.VarChar(100)
  type                 String?                @db.VarChar(500)
  weight_kg            Decimal?               @db.Decimal(18, 2)
  is_active            Boolean                @default(true)
  minimum_stock        Decimal                @db.Decimal(12, 3)
  last_purchase_price  Decimal?               @db.Decimal(12, 2)
  cif_percentage       Decimal?               @db.Decimal(5, 2)
  categories           categories             @relation(fields: [category_id], references: [id], onUpdate: NoAction, map: "f_k_articles__categories_category_id")
  supplier             suppliers?             @relation(fields: [supplier_id], references: [id], onUpdate: NoAction, map: "f_k_articles__suppliers_supplier_id")
  delivery_note_items  delivery_note_items[]
  invoice_items        invoice_items[]
  price_history        price_history[]
  sales_order_items    sales_order_items[]
  stock_movements      stock_movements[]
  supplier_order_items supplier_order_items[]

  @@index([supplier_id], map: "IX_articles_supplier_id")
}

model categories {
  id                         BigInt                       @id(map: "PK_categories") @default(autoincrement())
  code                       String                       @db.VarChar(20)
  name                       String                       @db.VarChar(100)
  description                String?                      @db.VarChar(500)
  default_discount_percent   Decimal                      @db.Decimal(5, 2)
  created_at                 DateTime                     @db.Timestamptz(6)
  updated_at                 DateTime                     @db.Timestamptz(6)
  deleted_at                 DateTime?                    @db.Timestamptz(6)
  created_by                 Int?
  updated_by                 Int?
  is_active                  Boolean                      @default(false)
  articles                   articles[]
  category_payment_discounts category_payment_discounts[]
  client_discounts           client_discounts[]
}

model client_discounts {
  id               BigInt     @id(map: "PK_client_discounts") @default(autoincrement())
  client_id        BigInt
  category_id      BigInt
  discount_percent Decimal    @db.Decimal
  created_at       DateTime   @db.Timestamptz(6)
  updated_at       DateTime   @db.Timestamptz(6)
  categories       categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_client_discounts_categories_category_id")
  clients          clients    @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_client_discounts_clients_client_id")

  @@index([category_id], map: "IX_client_discounts_category_id")
  @@index([client_id], map: "IX_client_discounts_client_id")
}

model clients {
  id                BigInt              @id(map: "PK_clients") @default(autoincrement())
  code              String              @db.VarChar(20)
  business_name     String              @db.VarChar(200)
  cuit              String?             @db.VarChar(11)
  tax_condition_id  Int
  address           String?             @db.VarChar(200)
  city              String?             @db.VarChar(100)
  postal_code       String?             @db.VarChar(10)
  province_id       Int?
  phone             String?             @db.VarChar(50)
  email             String?             @db.VarChar(100)
  operation_type_id Int
  transporter_id    Int?
  credit_limit      Decimal?            @db.Decimal(18, 2)
  payment_term_id   Int?
  created_at        DateTime            @db.Timestamptz(6)
  updated_at        DateTime            @db.Timestamptz(6)
  deleted_at        DateTime?           @db.Timestamptz(6)
  created_by        Int?
  updated_by        Int?
  seller_id         Int?
  account_movements account_movements[]
  client_discounts  client_discounts[]
  operation_types   operation_types     @relation(fields: [operation_type_id], references: [id], onUpdate: NoAction, map: "f_k_clients__operation_types_operation_type_id")
  provinces         provinces?          @relation(fields: [province_id], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "f_k_clients__provinces_province_id")
  payment_terms     payment_terms?      @relation(fields: [payment_term_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "f_k_clients__payment_terms_payment_term_id")
  tax_conditions    tax_conditions      @relation(fields: [tax_condition_id], references: [id], onUpdate: NoAction, map: "f_k_clients__tax_conditions_tax_condition_id")
  transporters      transporters?       @relation(fields: [transporter_id], references: [id], onUpdate: NoAction, map: "f_k_clients__transporters_transporter_id")
  sales_orders      sales_orders[]

  @@index([operation_type_id], map: "IX_clients_operation_type_id")
  @@index([province_id], map: "IX_clients_province_id")
  @@index([payment_term_id], map: "IX_clients_payment_term_id")
  @@index([tax_condition_id], map: "IX_clients_tax_condition_id")
  @@index([transporter_id], map: "IX_clients_transporter_id")
}

model delivery_notes {
  id                  BigInt                @id(map: "PK_delivery_notes") @default(autoincrement())
  delivery_number     String
  sales_order_id      BigInt
  delivery_date       DateTime              @db.Timestamptz(6)
  transporter_id      Int?
  weight_kg           Decimal?              @db.Decimal
  packages_count      Int?
  declared_value      Decimal?              @db.Decimal
  notes               String?
  created_at          DateTime              @db.Timestamptz(6)
  updated_at          DateTime              @db.Timestamptz(6)
  deleted_at          DateTime?             @db.Timestamptz(6)
  created_by          Int?
  updated_by          Int?
  is_printed          Boolean               @default(false)
  printed_at          DateTime?             @db.Timestamptz(6)
  delivery_note_items delivery_note_items[]
  sales_orders        sales_orders          @relation(fields: [sales_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_delivery_notes__sales_orders_sales_order_id")
  transporters        transporters?         @relation(fields: [transporter_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "f_k_delivery_notes__transporters_transporter_id")

  @@index([sales_order_id], map: "IX_delivery_notes_sales_order_id")
  @@index([transporter_id], map: "IX_delivery_notes_transporter_id")
}

model invoices {
  id                  BigInt          @id(map: "PK_invoices") @default(autoincrement())
  invoice_number      String          @db.VarChar(20)
  sales_order_id      BigInt
  invoice_date        DateTime        @db.Timestamptz(6)
  net_amount          Decimal         @db.Decimal(18, 4)
  tax_amount          Decimal         @db.Decimal(18, 4)
  total_amount        Decimal         @db.Decimal(18, 4)
  notes               String?
  created_at          DateTime        @db.Timestamptz(6)
  updated_at          DateTime        @db.Timestamptz(6)
  deleted_at          DateTime?       @db.Timestamptz(6)
  created_by          Int?
  updated_by          Int?
  cancellation_reason String?
  cancelled_at        DateTime?       @db.Timestamptz(6)
  is_cancelled        Boolean         @default(false)
  is_printed          Boolean         @default(false)
  printed_at          DateTime?       @db.Timestamptz(6)
  usd_exchange_rate   Decimal?        @db.Decimal(10, 4)
  is_credit_note      Boolean         @default(false)
  is_quotation        Boolean         @default(false)
  payment_term_id     Int?
  invoice_items       invoice_items[]
  payment_terms       payment_terms?  @relation(fields: [payment_term_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "f_k_invoices__payment_terms_payment_term_id")
  sales_orders        sales_orders    @relation(fields: [sales_order_id], references: [id], onUpdate: NoAction, map: "f_k_invoices__sales_orders_sales_order_id")

  @@index([payment_term_id], map: "IX_invoices_payment_term_id")
}

model delivery_note_items {
  id                  BigInt         @id(map: "PK_delivery_note_items") @default(autoincrement())
  delivery_note_id    BigInt
  sales_order_item_id BigInt?
  article_id          BigInt
  article_code        String         @db.VarChar(50)
  article_description String         @db.VarChar(500)
  quantity            Int
  created_at          DateTime       @db.Timestamptz(6)
  articles            articles       @relation(fields: [article_id], references: [id], onUpdate: NoAction, map: "f_k_delivery_note_items__articles_article_id")
  delivery_notes      delivery_notes @relation(fields: [delivery_note_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_delivery_note_items__delivery_notes_delivery_note_id")

  @@index([delivery_note_id], map: "ix_delivery_note_items_delivery_note_id")
  @@index([article_id], map: "ix_delivery_note_items_article_id")
  @@index([sales_order_item_id], map: "ix_delivery_note_items_sales_order_item_id")
}

model invoice_items {
  id                  BigInt   @id(map: "PK_invoice_items") @default(autoincrement())
  invoice_id          BigInt
  sales_order_item_id BigInt?
  article_id          BigInt
  article_code        String   @db.VarChar(50)
  article_description String   @db.VarChar(500)
  quantity            Int
  unit_price_usd      Decimal  @db.Decimal(18, 4)
  unit_price_ars      Decimal  @db.Decimal(18, 4)
  discount_percent    Decimal  @db.Decimal(5, 2)
  line_total          Decimal  @db.Decimal(18, 2)
  created_at          DateTime @db.Timestamptz(6)
  articles            articles @relation(fields: [article_id], references: [id], onUpdate: NoAction, map: "f_k_invoice_items__articles_article_id")
  invoices            invoices @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_invoice_items__invoices_invoice_id")

  @@index([invoice_id], map: "ix_invoice_items_invoice_id")
  @@index([article_id], map: "ix_invoice_items_article_id")
  @@index([sales_order_item_id], map: "ix_invoice_items_sales_order_item_id")
  @@index([article_id, invoice_id], map: "idx_invoice_items_article_invoice")
  @@index([article_id, line_total], map: "idx_invoice_items_line_total")
}

model operation_types {
  id          Int       @id(map: "PK_operation_types") @default(autoincrement())
  name        String
  description String?
  created_at  DateTime  @db.Timestamptz(6)
  clients     clients[]
}

model payment_methods {
  id                  Int                 @id(map: "PK_payment_methods") @default(autoincrement())
  name                String
  requires_check_data Boolean
  is_active           Boolean
  created_at          DateTime            @db.Timestamptz(6)
  account_movements   account_movements[]
}

model payment_terms {
  id                         Int                          @id(map: "PK_payment_terms") @default(autoincrement())
  code                       String                       @unique @db.VarChar(20)
  name                       String                       @db.VarChar(100)
  days                       Int
  is_active                  Boolean                      @default(true)
  created_at                 DateTime                     @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime                     @updatedAt @db.Timestamptz(6)
  created_by                 Int?
  updated_by                 Int?
  category_payment_discounts category_payment_discounts[]
  clients                    clients[]
  invoices                   invoices[]
  sales_orders               sales_orders[]

  @@index([code], map: "IX_payment_terms_code")
}

model category_payment_discounts {
  id               BigInt        @id(map: "PK_category_payment_discounts") @default(autoincrement())
  category_id      BigInt
  payment_term_id  Int
  discount_percent Decimal       @db.Decimal(5, 2)
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  updated_at       DateTime      @updatedAt @db.Timestamptz(6)
  categories       categories    @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_category_payment_discounts__categories_category_id")
  payment_terms    payment_terms @relation(fields: [payment_term_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_category_payment_discounts__payment_terms_payment_term_id")

  @@unique([category_id, payment_term_id], map: "UQ_category_payment_discounts")
  @@index([category_id], map: "IX_category_payment_discounts_category_id")
  @@index([payment_term_id], map: "IX_category_payment_discounts_payment_term_id")
}

model provinces {
  id         Int       @id(map: "PK_provinces") @default(autoincrement())
  name       String
  code       String?
  created_at DateTime  @db.Timestamptz(6)
  clients    clients[]
}

model sales_order_items {
  id               BigInt       @id(map: "PK_sales_order_items") @default(autoincrement())
  sales_order_id   BigInt
  article_id       BigInt
  quantity         Int
  unit_price       Decimal      @db.Decimal(18, 4)
  discount_percent Decimal      @db.Decimal(5, 2)
  line_total       Decimal      @db.Decimal(18, 2)
  created_at       DateTime     @db.Timestamptz(6)
  articles         articles     @relation(fields: [article_id], references: [id], onUpdate: NoAction, map: "f_k_sales_order_items_articles_article_id")
  sales_orders     sales_orders @relation(fields: [sales_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_sales_order_items_sales_orders_sales_order_id")

  @@index([article_id], map: "IX_sales_order_items_article_id")
  @@index([sales_order_id, article_id], map: "IX_sales_order_items_sales_order_id_article_id")
}

model sales_orders {
  id                       BigInt              @id(map: "PK_sales_orders") @default(autoincrement())
  client_id                BigInt
  order_number             String              @unique(map: "IX_sales_orders_order_number") @db.VarChar(20)
  order_date               DateTime            @db.Timestamptz(6)
  delivery_date            DateTime?           @db.Timestamptz(6)
  status                   String
  total                    Decimal             @db.Decimal(18, 4)
  notes                    String?
  created_at               DateTime            @db.Timestamptz(6)
  updated_at               DateTime            @db.Timestamptz(6)
  deleted_at               DateTime?           @db.Timestamptz(6)
  created_by               Int?
  updated_by               Int?
  special_discount_percent Decimal             @default(0.0) @db.Decimal
  payment_term_id          Int?
  delivery_notes           delivery_notes[]
  invoices                 invoices[]
  sales_order_items        sales_order_items[]
  payment_terms            payment_terms?      @relation(fields: [payment_term_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "f_k_sales_orders__payment_terms_payment_term_id")
  clients                  clients             @relation(fields: [client_id], references: [id], onUpdate: NoAction, map: "f_k_sales_orders_clients_client_id")

  @@index([client_id], map: "IX_sales_orders_client_id")
  @@index([payment_term_id], map: "IX_sales_orders_payment_term_id")
}

model stock_movements {
  id                 BigInt    @id(map: "PK_stock_movements") @default(autoincrement())
  article_id         BigInt
  movement_type      Int
  quantity           Int
  reference_document String?
  movement_date      DateTime  @db.Timestamptz(6)
  notes              String?
  created_at         DateTime  @db.Timestamptz(6)
  updated_at         DateTime  @db.Timestamptz(6)
  deleted_at         DateTime? @db.Timestamptz(6)
  created_by         Int?
  updated_by         Int?
  articles           articles  @relation(fields: [article_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_stock_movements_articles_article_id")

  @@index([article_id], map: "IX_stock_movements_article_id")
}

model tax_conditions {
  id          Int       @id(map: "PK_tax_conditions") @default(autoincrement())
  name        String
  description String?
  created_at  DateTime  @db.Timestamptz(6)
  clients     clients[]
}

model transporters {
  id             Int              @id(map: "PK_transporters") @default(autoincrement())
  name           String
  address        String?
  phone          String?
  email          String?
  is_active      Boolean
  created_at     DateTime         @db.Timestamptz(6)
  updated_at     DateTime         @db.Timestamptz(6)
  deleted_at     DateTime?        @db.Timestamptz(6)
  clients        clients[]
  delivery_notes delivery_notes[]
}

model users {
  id            Int       @id(map: "PK_users") @default(autoincrement())
  username      String    @unique(map: "IX_users_username") @db.VarChar(50)
  email         String    @unique(map: "IX_users_email") @db.VarChar(100)
  password_hash String    @db.VarChar(255)
  full_name     String    @db.VarChar(150)
  role          String
  is_active     Boolean
  last_login_at DateTime? @db.Timestamptz(6)
  created_at    DateTime  @db.Timestamptz(6)
  updated_at    DateTime  @db.Timestamptz(6)
}

model system_settings {
  id                Int      @id @default(1)
  usd_exchange_rate Decimal  @db.Decimal(10, 4)
  updated_at        DateTime @db.Timestamptz(6)
  updated_by        Int?
}

model certificates {
  id                  BigInt                @id(map: "PK_certificates") @default(autoincrement())
  file_name           String                @db.VarChar(500)
  storage_path        String                @unique @db.VarChar(1000)
  original_path       String?               @db.VarChar(1000)
  file_type           String                @db.VarChar(50)
  file_size_bytes     BigInt?
  category            String?               @db.VarChar(100)
  notes               String?
  extracted_text      String?
  created_at          DateTime              @default(now()) @db.Timestamptz(6)
  updated_at          DateTime              @updatedAt @db.Timestamptz(6)
  deleted_at          DateTime?             @db.Timestamptz(6)
  created_by          Int?
  certificate_coladas certificate_coladas[]

  @@index([category], map: "IX_certificates_category")
  @@index([category])
  @@index([created_at])
}

model coladas {
  id                  BigInt                @id(map: "PK_coladas") @default(autoincrement())
  colada_number       String                @unique @db.VarChar(50)
  description         String?               @db.VarChar(500)
  supplier            String?               @db.VarChar(200)
  material_type       String?               @db.VarChar(100)
  created_at          DateTime              @default(now()) @db.Timestamptz(6)
  updated_at          DateTime              @updatedAt @db.Timestamptz(6)
  certificate_coladas certificate_coladas[]

  @@index([colada_number], map: "IX_coladas_colada_number")
  @@index([colada_number])
}

model certificate_coladas {
  id             BigInt       @id @default(autoincrement())
  certificate_id BigInt
  colada_id      BigInt
  created_at     DateTime     @default(now()) @db.Timestamptz(6)
  certificates   certificates @relation(fields: [certificate_id], references: [id])
  colada         coladas      @relation(fields: [colada_id], references: [id])

  @@unique([certificate_id, colada_id], map: "UQ_certificate_coladas")
  @@unique([certificate_id, colada_id])
  @@index([certificate_id], map: "IX_certificate_coladas_certificate_id")
  @@index([colada_id], map: "IX_certificate_coladas_colada_id")
  @@index([certificate_id])
  @@index([colada_id])
}

model activity_logs {
  id               BigInt             @id @default(autoincrement())
  user_id          Int?
  username         String             @db.VarChar(50)
  operation        String             @db.VarChar(50)
  description      String             @db.VarChar(500)
  entity_type      String?            @db.VarChar(50)
  entity_id        BigInt?
  details          Json?
  ip_address       String?            @db.VarChar(50)
  created_at       DateTime           @default(now()) @db.Timestamptz(6)
  activity_changes activity_changes[]

  @@index([user_id])
  @@index([operation])
  @@index([entity_type])
  @@index([created_at])
}

model activity_changes {
  id              BigInt        @id @default(autoincrement())
  activity_log_id BigInt
  entity_type     String        @db.VarChar(50)
  entity_id       BigInt?
  entity_label    String?       @db.VarChar(200)
  before_state    Json?
  after_state     Json?
  created_at      DateTime      @default(now()) @db.Timestamptz(6)
  activity_logs   activity_logs @relation(fields: [activity_log_id], references: [id], onDelete: Cascade)

  @@index([activity_log_id])
  @@index([entity_type])
}

model feedback {
  id          BigInt    @id @default(autoincrement())
  user_id     Int?
  username    String    @db.VarChar(50)
  full_name   String    @db.VarChar(150)
  type        String    @db.VarChar(50)
  subject     String    @db.VarChar(200)
  description String
  status      String    @default("pending") @db.VarChar(50)
  priority    String?   @db.VarChar(50)
  admin_notes String?
  resolved_at DateTime? @db.Timestamptz(6)
  resolved_by Int?
  created_at  DateTime  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime  @updatedAt @db.Timestamptz(6)

  @@index([user_id])
  @@index([status])
  @@index([type])
  @@index([created_at])
}

model suppliers {
  id              Int               @id @default(autoincrement())
  code            String            @unique @db.VarChar(20)
  name            String            @db.VarChar(200)
  contact_name    String?           @db.VarChar(100)
  email           String?           @db.VarChar(100)
  phone           String?           @db.VarChar(50)
  address         String?           @db.VarChar(300)
  notes           String?
  is_active       Boolean           @default(true)
  created_at      DateTime          @default(now()) @db.Timestamptz(6)
  updated_at      DateTime          @updatedAt @db.Timestamptz(6)
  deleted_at      DateTime?         @db.Timestamptz(6)
  created_by      Int?
  updated_by      Int?
  articles        articles[]
  supplier_orders supplier_orders[]

  @@index([code], map: "IX_suppliers_code")
  @@index([name], map: "IX_suppliers_name")
}

model supplier_orders {
  id                         BigInt                 @id @default(autoincrement())
  order_number               String                 @unique @db.VarChar(20)
  supplier_id                Int?
  status                     String                 @default("draft") @db.VarChar(20)
  order_date                 DateTime               @default(now()) @db.Timestamptz(6)
  expected_delivery_date     DateTime?              @db.Timestamptz(6)
  actual_delivery_date       DateTime?              @db.Timestamptz(6)
  total_items                Int                    @default(0)
  total_quantity             Int                    @default(0)
  estimated_sale_time_months Decimal?               @db.Decimal(10, 2)
  notes                      String?
  created_at                 DateTime               @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime               @updatedAt @db.Timestamptz(6)
  deleted_at                 DateTime?              @db.Timestamptz(6)
  created_by                 Int?
  updated_by                 Int?
  supplier_order_items       supplier_order_items[]
  supplier                   suppliers?             @relation(fields: [supplier_id], references: [id], onUpdate: NoAction, map: "f_k_supplier_orders__suppliers_supplier_id")

  @@index([supplier_id], map: "IX_supplier_orders_supplier_id")
  @@index([status], map: "IX_supplier_orders_status")
  @@index([order_date], map: "IX_supplier_orders_order_date")
}

model supplier_order_items {
  id                   BigInt          @id @default(autoincrement())
  supplier_order_id    BigInt
  article_id           BigInt
  article_code         String          @db.VarChar(50)
  article_description  String          @db.VarChar(500)
  quantity             Int
  current_stock        Decimal         @db.Decimal(12, 3)
  minimum_stock        Decimal         @db.Decimal(12, 3)
  avg_monthly_sales    Decimal?        @db.Decimal(10, 2)
  estimated_sale_time  Decimal?        @db.Decimal(10, 2)
  received_quantity    Int             @default(0)
  created_at           DateTime        @default(now()) @db.Timestamptz(6)
  db_total_price       Decimal?        @db.Decimal(15, 2)
  db_unit_price        Decimal?        @db.Decimal(12, 2)
  margin_absolute      Decimal?        @db.Decimal(12, 2)
  margin_percent       Decimal?        @db.Decimal(10, 2)
  proforma_total_price Decimal?        @db.Decimal(15, 2)
  proforma_unit_price  Decimal?        @db.Decimal(12, 2)
  unit_weight          Decimal?        @db.Decimal(10, 3)
  article              articles        @relation(fields: [article_id], references: [id], onUpdate: NoAction, map: "f_k_supplier_order_items__articles_article_id")
  supplier_order       supplier_orders @relation(fields: [supplier_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_supplier_order_items__supplier_orders_supplier_order_id")

  @@index([supplier_order_id], map: "IX_supplier_order_items_supplier_order_id")
  @@index([article_id], map: "IX_supplier_order_items_article_id")
}

model price_history {
  id              BigInt   @id @default(autoincrement())
  article_id      BigInt
  old_price       Decimal  @db.Decimal(18, 4)
  new_price       Decimal  @db.Decimal(18, 4)
  change_type     String   @db.VarChar(50)
  changed_by      Int?
  changed_by_name String?  @db.VarChar(100)
  notes           String?
  created_at      DateTime @default(now()) @db.Timestamptz(6)
  change_batch_id String?  @db.VarChar(100)
  articles        articles @relation(fields: [article_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "f_k_price_history__articles_article_id")

  @@index([article_id], map: "IX_price_history_article_id")
  @@index([created_at], map: "IX_price_history_created_at")
  @@index([changed_by], map: "IX_price_history_changed_by")
  @@index([change_batch_id], map: "IX_price_history_change_batch_id")
}

model price_import_drafts {
  id            BigInt   @id @default(autoincrement())
  user_id       Int
  draft_data    Json     @db.JsonB
  article_count Int      @default(0)
  created_at    DateTime @default(now()) @db.Timestamptz(6)
  updated_at    DateTime @updatedAt @db.Timestamptz(6)

  @@unique([user_id], map: "idx_price_import_drafts_user_id")
}