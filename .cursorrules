# Cursor AI Rules - SPISA Project

## ğŸ¯ REGLA FUNDAMENTAL

**TODOS los cambios realizados por la IA DEBEN seguir estrictamente los patrones arquitectÃ³nicos y de cÃ³digo existentes en el proyecto.**

Antes de escribir cualquier cÃ³digo:
1. âœ… Lee la documentaciÃ³n en `docs/`
2. âœ… Busca ejemplos similares en el codebase
3. âœ… Sigue los patrones identificados
4. âŒ NO inventes nuevos patrones sin justificaciÃ³n

## ğŸ“š DocumentaciÃ³n Obligatoria

Lee y aplica las siguientes guÃ­as antes de hacer cambios:

### Arquitectura
- `docs/architecture-overview.md` - Estructura general del proyecto
- `docs/folder-structure-analysis.md` - OrganizaciÃ³n de carpetas
- `docs/components-interaction.md` - InteracciÃ³n entre componentes

### Desarrollo
- `docs/DEVELOPER_GUIDE.md` - GuÃ­a principal de desarrollo
- `docs/code-quality-tools.md` - Herramientas y estÃ¡ndares
- `docs/solid-principles-analysis.md` - Principios SOLID aplicados

### ImplementaciÃ³n
- `docs/IMPLEMENTATION_PLAN.md` - Plan de implementaciÃ³n
- `docs/MIGRATION_SUMMARY_2026.md` - Migraciones y cambios
- `docs/TECHNICAL_DEBT_COMPLETION.md` - Deuda tÃ©cnica resuelta

## ğŸ—ï¸ Patrones ArquitectÃ³nicos Obligatorios

### 1. Factory Pattern para Hooks (OBLIGATORIO)

âœ… **CORRECTO:**
```typescript
// frontend/lib/hooks/useEntity.ts
import { createCRUDHooks } from './api/createCRUDHooks';
import { entityApi } from '../api/entity';

const { useList, useById, useCreate, useUpdate, useDelete } = createCRUDHooks<
  Entity,
  EntityFormData,
  EntityFormData,
  EntityListParams
>({
  entityName: 'Entidad',
  api: entityApi,
  queryKey: 'entities',
});

export {
  useList as useEntities,
  useById as useEntity,
  useCreate as useCreateEntity,
  useUpdate as useUpdateEntity,
  useDelete as useDeleteEntity,
};
```

âŒ **INCORRECTO:**
```typescript
// NO crear hooks personalizados desde cero
export function useEntity() {
  const query = useQuery({ ... });
  return { ... }; // âŒ NO hacer esto
}
```

### 2. Estructura de Componentes

âœ… **CORRECTO:**
```
frontend/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ entities/
â”‚       â”œâ”€â”€ EntityDialog.tsx      # Formulario create/edit
â”‚       â”œâ”€â”€ EntitiesTable.tsx     # Tabla con acciones
â”‚       â””â”€â”€ EntityCard.tsx        # Opcional: vista de tarjeta
â”œâ”€â”€ app/
â”‚   â””â”€â”€ dashboard/
â”‚       â””â”€â”€ entities/
â”‚           â””â”€â”€ page.tsx          # PÃ¡gina principal CRUD
```

### 3. ValidaciÃ³n con Zod

âœ… **CORRECTO:**
```typescript
// frontend/lib/validations/schemas.ts
export const createEntitySchema = z.object({
  field: z.string().min(1, 'Campo requerido'),
  // ...
});

export const updateEntitySchema = createEntitySchema.partial();
```

### 4. API Layer

âœ… **CORRECTO:**
```typescript
// frontend/lib/api/entities.ts
import type { Entity, EntityFormData } from '@/types/entity';
import type { PagedResult } from '@/types/pagination';
import { apiClient } from './client';

export const entitiesApi = {
  getAll: async (params?): Promise<PagedResult<Entity>> => {
    const { data } = await apiClient.get<PagedResult<Entity>>('/entities', { params });
    return data;
  },
  // getById, create, update, delete...
};
```

### 5. Tipos TypeScript

âœ… **CORRECTO:**
```typescript
// frontend/types/entity.ts
export interface Entity {
  id: number;
  // ... campos
  createdAt: string;
  updatedAt: string;
}

export interface EntityFormData {
  // Solo campos editables (sin id, timestamps)
}
```

## ğŸ“‹ Checklist Antes de Commitear

- [ ] Â¿SeguÃ­ el factory pattern para hooks?
- [ ] Â¿UsÃ© los componentes UI existentes?
- [ ] Â¿AgreguÃ© validaciÃ³n con Zod?
- [ ] Â¿Los tipos estÃ¡n en `frontend/types/`?
- [ ] Â¿La API usa `PagedResult<T>`?
- [ ] Â¿SeguÃ­ la estructura de carpetas?
- [ ] Â¿RevisÃ© ejemplos similares en el cÃ³digo?
- [ ] Â¿El commit sigue Conventional Commits?

## ğŸš« Anti-Patrones - NO HACER

1. âŒ NO crear hooks personalizados sin usar `createCRUDHooks`
2. âŒ NO inventar nuevas estructuras de carpetas
3. âŒ NO mezclar lÃ³gica de negocio en componentes UI
4. âŒ NO hardcodear valores (usar constantes/config)
5. âŒ NO ignorar TypeScript errors (resolver todos)
6. âŒ NO duplicar cÃ³digo (buscar componentes reutilizables)
7. âŒ NO crear interfaces inconsistentes con el resto

## ğŸ” Proceso de ValidaciÃ³n

Antes de escribir cÃ³digo:

1. **Explora primero:**
   ```bash
   # Busca ejemplos similares
   grep -r "pattern" frontend/
   ```

2. **Lee la documentaciÃ³n:**
   - Revisa `docs/DEVELOPER_GUIDE.md`
   - Busca ejemplos en mÃ³dulos similares

3. **Sigue el patrÃ³n:**
   - Copia la estructura de un mÃ³dulo existente
   - Adapta los nombres y tipos
   - MantÃ©n la consistencia

4. **Valida:**
   - `npm run build` debe pasar
   - `npm run lint` debe pasar
   - TypeScript sin errores

## ğŸ“ Commits

Sigue **Conventional Commits**:
```
type(scope): subject en minÃºsculas

Body opcional explicando QUÃ‰ y POR QUÃ‰.

Co-Authored-By: Claude <noreply@anthropic.com>
```

Ver `.claude/COMMIT_GUIDE.md` para mÃ¡s detalles.

## ğŸ¨ Estilo de CÃ³digo

- **React**: Functional components con hooks
- **State**: React Query para server state, useState para UI
- **Forms**: React Hook Form + Zod
- **Styling**: Tailwind CSS con componentes shadcn/ui
- **TypeScript**: Strict mode, tipos explÃ­citos

## ğŸ”— Referencias RÃ¡pidas

- Factory Pattern: `frontend/lib/hooks/api/createCRUDHooks.ts`
- Ejemplo completo: `frontend/app/dashboard/categories/`
- UI Components: `frontend/components/ui/`
- Validaciones: `frontend/lib/validations/schemas.ts`
- API Client: `frontend/lib/api/client.ts`

## âš ï¸ IMPORTANTE

Si necesitas desviarte de los patrones existentes:
1. Consulta primero con el usuario
2. Documenta la razÃ³n en el commit
3. Actualiza la documentaciÃ³n en `docs/`

**La consistencia es mÃ¡s importante que la perfecciÃ³n.**
