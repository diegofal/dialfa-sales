{
  "permissions": {
    "allow": [
      "Bash(find:*)",
      "Bash(npm run build:*)",
      "Bash(tasklist)",
      "Bash(npm install:*)",
      "Bash(npx jest --no-coverage)",
      "Bash(npx jest:*)",
      "Bash(npx prettier --write .)",
      "Bash(git -C \"D:\\\\dialfa new\\\\spisa-new\" rev-parse --show-toplevel)",
      "Bash(node -e:*)",
      "Bash(npm run prepare:*)",
      "Bash(npx eslint:*)",
      "Bash(npx tsc:*)",
      "Bash(ls \"D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\lib\\\\api\"\" 2>&1 || echo \"Directory does not exist \")",
      "Bash(npx prettier:*)",
      "Bash(git ls-files:*)",
      "Bash(echo:*)",
      "Bash(powershell -Command \"@\"\"\nimport { NextRequest, NextResponse } from ''next/server'';\nimport { handleError } from ''@/lib/errors'';\nimport * as AuthService from ''@/lib/services/AuthService'';\n\nexport async function POST\\(request: NextRequest\\) {\n  try {\n    const { username, password } = await request.json\\(\\);\n    const result = await AuthService.login\\(username, password, request\\);\n\n    if \\(result.error\\) {\n      return NextResponse.json\\({ error: result.error }, { status: result.status }\\);\n    }\n\n    return NextResponse.json\\(result.data, { status: result.status }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\"\"@ | Set-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\auth\\\\login\\\\route.ts'' -Encoding UTF8\")",
      "Bash(powershell -Command \"@\"\"\nimport { NextResponse } from ''next/server'';\nimport { handleError } from ''@/lib/errors'';\nimport * as AuthService from ''@/lib/services/AuthService'';\n\nexport async function GET\\(\\) {\n  try {\n    const user = await AuthService.validateSession\\(\\);\n\n    if \\(!user\\) {\n      return NextResponse.json\\({ error: ''Not authenticated'' }, { status: 401 }\\);\n    }\n\n    return NextResponse.json\\({ user }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\"\"@ | Set-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\auth\\\\me\\\\route.ts'' -Encoding UTF8\")",
      "Bash(powershell -Command \"@\"\"\nimport { NextResponse } from ''next/server'';\nimport { handleError } from ''@/lib/errors'';\nimport * as DashboardService from ''@/lib/services/DashboardService'';\n\nexport async function GET\\(\\) {\n  try {\n    const metrics = await DashboardService.getMetrics\\(\\);\n    return NextResponse.json\\(metrics\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\"\"@ | Set-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\dashboard\\\\metrics\\\\route.ts'' -Encoding UTF8\")",
      "Bash(powershell -Command \"@\"\"\nimport { NextResponse } from ''next/server'';\nimport { handleError } from ''@/lib/errors'';\nimport * as DashboardService from ''@/lib/services/DashboardService'';\n\nexport async function GET\\(\\) {\n  try {\n    const charts = await DashboardService.getCharts\\(\\);\n    return NextResponse.json\\(charts\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\"\"@ | Set-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\dashboard\\\\charts\\\\route.ts'' -Encoding UTF8\")",
      "Bash(powershell.exe -NoProfile -Command \"\n$content = @''\nimport { NextRequest, NextResponse } from ''next/server'';\nimport { z } from ''zod'';\nimport { requireAdmin } from ''@/lib/auth/roles'';\nimport { handleError } from ''@/lib/errors'';\nimport * as PriceListService from ''@/lib/services/PriceListService'';\n\nconst bulkPriceUpdateSchema = z.object\\({\n  updates: z\n    .array\\(\n      z.object\\({\n        articleId: z.number\\(\\),\n        newPrice: z.number\\(\\).min\\(0, ''El precio debe ser mayor o igual a 0''\\),\n      }\\)\n    \\)\n    .min\\(1, ''Debe haber al menos una actualizacion''\\),\n  changeType: z.enum\\([''manual'', ''csv_import'', ''bulk_update'']\\).optional\\(\\).default\\(''bulk_update''\\),\n  notes: z.string\\(\\).optional\\(\\),\n}\\);\n\nexport async function PUT\\(request: NextRequest\\) {\n  try {\n    const { authorized, error, user } = requireAdmin\\(request\\);\n    if \\(!authorized\\) {\n      return error || NextResponse.json\\({ error: ''Unauthorized'' }, { status: 401 }\\);\n    }\n\n    const body = await request.json\\(\\);\n    const validatedData = bulkPriceUpdateSchema.parse\\(body\\);\n\n    const result = await PriceListService.bulkUpdate\\(\n      validatedData,\n      user?.userId,\n      user?.email,\n      request\n    \\);\n\n    return NextResponse.json\\({ success: true, ...result }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n''@\nSet-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\price-lists\\\\bulk-update\\\\route.ts'' -Value $content -Encoding UTF8\n\")",
      "Bash(powershell.exe -NoProfile -Command \"\n$content = @''\nimport { NextRequest, NextResponse } from ''next/server'';\nimport { z } from ''zod'';\nimport { requireAdmin } from ''@/lib/auth/roles'';\nimport { handleError } from ''@/lib/errors'';\nimport * as PriceListService from ''@/lib/services/PriceListService'';\n\nconst saveDraftSchema = z.object\\({\n  draftData: z.record\\(z.string\\(\\), z.number\\(\\)\\),\n}\\);\n\nexport async function GET\\(request: NextRequest\\) {\n  try {\n    const { authorized, error, user } = requireAdmin\\(request\\);\n    if \\(!authorized\\) {\n      return error || NextResponse.json\\({ error: ''Unauthorized'' }, { status: 401 }\\);\n    }\n\n    if \\(!user?.userId\\) {\n      return NextResponse.json\\({ error: ''User ID not found'' }, { status: 400 }\\);\n    }\n\n    const draft = await PriceListService.getDraft\\(user.userId\\);\n    return NextResponse.json\\({ draft }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\nexport async function POST\\(request: NextRequest\\) {\n  try {\n    const { authorized, error, user } = requireAdmin\\(request\\);\n    if \\(!authorized\\) {\n      return error || NextResponse.json\\({ error: ''Unauthorized'' }, { status: 401 }\\);\n    }\n\n    if \\(!user?.userId\\) {\n      return NextResponse.json\\({ error: ''User ID not found'' }, { status: 400 }\\);\n    }\n\n    const body = await request.json\\(\\);\n    const validated = saveDraftSchema.parse\\(body\\);\n\n    const result = await PriceListService.saveDraft\\(user.userId, validated.draftData\\);\n    return NextResponse.json\\({ success: true, ...result }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n\nexport async function DELETE\\(request: NextRequest\\) {\n  try {\n    const { authorized, error, user } = requireAdmin\\(request\\);\n    if \\(!authorized\\) {\n      return error || NextResponse.json\\({ error: ''Unauthorized'' }, { status: 401 }\\);\n    }\n\n    if \\(!user?.userId\\) {\n      return NextResponse.json\\({ error: ''User ID not found'' }, { status: 400 }\\);\n    }\n\n    await PriceListService.deleteDraft\\(user.userId\\);\n    return NextResponse.json\\({ success: true }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n''@\nSet-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\price-lists\\\\draft\\\\route.ts'' -Value $content -Encoding UTF8\n\")",
      "Bash(powershell.exe -NoProfile -Command \"\n$content = @''\nimport { NextRequest, NextResponse } from ''next/server'';\nimport { requireAdmin } from ''@/lib/auth/roles'';\nimport { handleError } from ''@/lib/errors'';\nimport * as PriceListService from ''@/lib/services/PriceListService'';\n\nexport async function POST\\(request: NextRequest\\) {\n  try {\n    const { authorized, error, user } = requireAdmin\\(request\\);\n    if \\(!authorized\\) {\n      return error || NextResponse.json\\({ error: ''Unauthorized'' }, { status: 401 }\\);\n    }\n\n    const body = await request.json\\(\\);\n    const { priceHistoryId } = body;\n\n    if \\(!priceHistoryId\\) {\n      return NextResponse.json\\({ error: ''priceHistoryId is required'' }, { status: 400 }\\);\n    }\n\n    const result = await PriceListService.revertSingle\\(\n      priceHistoryId,\n      user?.userId,\n      user?.email,\n      request\n    \\);\n\n    if \\(''error'' in result\\) {\n      return NextResponse.json\\({ error: result.error }, { status: result.status }\\);\n    }\n\n    return NextResponse.json\\({ success: true, message: ''Precio revertido exitosamente'', article: result.data }\\);\n  } catch \\(error\\) {\n    return handleError\\(error\\);\n  }\n}\n''@\nSet-Content -Path ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\price-lists\\\\revert\\\\route.ts'' -Value $content -Encoding UTF8\n\")",
      "Bash(powershell -Command \"Get-Content ''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\delivery-notes\\\\route.ts''\")",
      "Bash(powershell -Command \"[System.IO.File]::ReadAllText\\(''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\delivery-notes\\\\[id]\\\\route.ts''\\)\")",
      "Bash(powershell -Command \"[System.IO.File]::ReadAllText\\(''D:\\\\dialfa new\\\\spisa-new\\\\frontend\\\\app\\\\api\\\\delivery-notes\\\\[id]\\\\print\\\\route.ts''\\)\")",
      "Bash(grep:*)",
      "Bash(npm test:*)",
      "Bash(npm run lint)",
      "Bash(npm run lint:*)",
      "Bash(npx lint-staged)",
      "Bash(git commit:*)"
    ]
  }
}
