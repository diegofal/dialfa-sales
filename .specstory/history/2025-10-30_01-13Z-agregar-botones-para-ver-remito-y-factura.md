<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session be22a8d3-96c3-4a59-ade3-95bc0b284440 (2025-10-30 01:13Z) -->

# Agregar botones para ver remito y factura (2025-10-30 01:13Z)

_**User (2025-10-30 01:12Z)**_

 abajo donde vemos Generar Remito y Guardar cambios, deberia haber botones "Ver Remito" y "Ver Factura" si los mismos estan generados.  

---

_**Agent (model claude-4.5-sonnet-thinking, mode Agent)**_

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Primero debo explorar el código para encontrar:
- El componente de edición de pedido
- Cómo se manejan los estados de remito y factura
- La estructura de datos del pedido</details></think>

---

Entiendo. Necesitas agregar botones "Ver Remito" y "Ver Factura" en la parte inferior cuando estos documentos ya están generados para ese pedido. Déjame explorar el código para ver cómo está estructurado actualmente.

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">

</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">

</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "Generar Remito" in "." • 8 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `.\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L33 |
| `.\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L38 |
| `.\Backup\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L33 |
| `.\Backup\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L38 |
| `.\SPISA.Presentacion\bin\Debug\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L33 |
| `.\SPISA.Presentacion\bin\Debug\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L38 |
| `.\v2.0\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L33 |
| `.\v2.0\SPISA.Presentacion\ExplorerBarGroups.xml` | `<item tag="itemGenerarRemito">Generar Remito</item>` | L38 |


</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "Guardar Cambios" in "." • 0 matches</summary>

Output mode: content


_No matches found_

</details>
</tool-use>

---

Could not find file 'frontend/components/salesOrders/SingleStepOrderForm.tsx' in the workspace.

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

</details>
</tool-use>

---

Perfecto, ahora veo la estructura. Déjame ver más del código para entender la estructura de datos y cómo se manejan el remito y la factura:

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Primero debo explorar el código para encontrar:
- El componente de edición de pedido
- Cómo se manejan los estados de remito y factura
- La estructura de datos del pedido

Ya vi que en la línea 1113 está la condición `!existingOrder?.deliveryNote` que verifica si NO existe el remito. Esto significa que `existingOrder` tiene una propiedad `deliveryNote` que indica si hay un remito generado.

Necesito ver qué propiedades tiene el `existingOrder` para saber cómo verificar si existe una factura también.</details></think>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "interface.*SalesOrder|type.*SalesOrder" in "spisa-new/frontend" • 28 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `frontend\components\salesOrders\SalesOrdersTable.tsx` | `import type \{ SalesOrderListDto \} from '@/types/salesOrder';` | L25 |
| `frontend\components\salesOrders\SalesOrdersTable.tsx` | `interface SalesOrdersTableProps \{` | L28 |
| `frontend\types\salesOrder.ts` | `export interface SalesOrder \{` | L1 |
| `frontend\types\salesOrder.ts` | `export interface SalesOrderItem \{` | L31 |
| `frontend\types\salesOrder.ts` | `export interface SalesOrderListDto \{` | L43 |
| `frontend\types\salesOrder.ts` | `export interface CreateSalesOrderRequest \{` | L54 |
| `frontend\types\salesOrder.ts` | `export interface CreateSalesOrderItemRequest \{` | L62 |
| `frontend\types\salesOrder.ts` | `export interface UpdateSalesOrderRequest \{` | L69 |
| `frontend\types\salesOrder.ts` | `export interface UpdateSalesOrderItemRequest \{` | L77 |
| `frontend\types\salesOrder.ts` | `export interface SalesOrderFormData \{` | L86 |
| `frontend\types\salesOrder.ts` | `export interface SalesOrderItemFormData \{` | L94 |
| `frontend\app\api\sales-orders\[id]\permissions\route.ts` | `import type \{ SalesOrderStatus \} from '@/types/permissions';` | L4 |
| `frontend\lib\api\salesOrders.ts` | `import type \{ SalesOrderStatus, SalesOrderPermissions \} from '@/types/permissions';` | L11 |
| `frontend\lib\hooks\useSalesOrders.ts` | `import type \{ CreateSalesOrderRequest, UpdateSalesOrderRequest \} from '@/types/salesOrder';` | L4 |
| `frontend\types\permissions.ts` | `export interface SalesOrderStatus \{` | L2 |
| `frontend\types\permissions.ts` | `export interface SalesOrderPermissions \{` | L11 |
| `frontend\lib\permissions\salesOrders.ts` | `import type \{ SalesOrder \} from '@/types/salesOrder';` | L1 |
| `frontend\lib\permissions\salesOrders.ts` | `export interface SalesOrderValidationResult \{` | L56 |
| `frontend\lib\hooks\useSalesOrderPermissions.ts` | `import type \{ SalesOrder \} from '@/types/salesOrder';` | L2 |
| `frontend\lib\hooks\useSalesOrderPermissions.ts` | `import type \{ SalesOrderPermissions \} from '@/types/permissions';` | L3 |
| `frontend\lib\actions\sales-orders.ts` | `import \{ createSalesOrderSchema, updateSalesOrderSchema, type CreateSalesOrderInput, type UpdateSalesOrderInput \} from '@/lib/validations/schemas';` | L6 |
| `frontend\components\salesOrders\SalesOrderWizard.tsx` | `import type \{ SalesOrderFormData \} from '@/types/salesOrder';` | L10 |
| `frontend\components\salesOrders\OrderSummaryStep.tsx` | `import type \{ SalesOrderFormData, SalesOrderItemFormData \} from '@/types/salesOrder';` | L7 |
| `frontend\lib\validations\schemas.ts` | `export type SalesOrderItemInput = z.infer<typeof salesOrderItemSchema>;` | L109 |
| `frontend\lib\validations\schemas.ts` | `export type CreateSalesOrderInput = z.infer<typeof createSalesOrderSchema>;` | L110 |
| `frontend\lib\validations\schemas.ts` | `export type UpdateSalesOrderInput = z.infer<typeof updateSalesOrderSchema>;` | L111 |
| `frontend\components\salesOrders\ClientSelectionStep.tsx` | `import type \{ SalesOrderFormData \} from '@/types/salesOrder';` | L8 |
| `frontend\components\salesOrders\ItemsSelectionStep.tsx` | `import type \{ SalesOrderFormData, SalesOrderItemFormData \} from '@/types/salesOrder';` | L11 |


</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Primero debo explorar el código para encontrar:
- El componente de edición de pedido
- Cómo se manejan los estados de remito y factura
- La estructura de datos del pedido

Ya vi que en la línea 1113 está la condición `!existingOrder?.deliveryNote` que verifica si NO existe el remito. Esto significa que `existingOrder` tiene una propiedad `deliveryNote` que indica si hay un remito generado.

Necesito ver qué propiedades tiene el `existingOrder` para saber cómo verificar si existe una factura también.</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/types/salesOrder.ts</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Ya tengo la información necesaria:
- El `existingOrder` tiene propiedades `invoice` y `deliveryNote` que son objetos si existen o `null` si no existen.
- El botón "Generar Remito" solo se muestra cuando `!existingOrder?.deliveryNote` (línea 1113)
- Necesito agregar botones "Ver Remito" y "Ver Factura" cuando estos documentos existan

Ahora necesito ver si existen rutas para ver estos documentos. Déjame buscar rutas de remitos y facturas.</details></think>

---

Perfecto, ahora entiendo la estructura. Déjame buscar las rutas para ver remitos y facturas:

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "delivery.*note|remito" in "spisa-new/frontend" • 17 matches</summary>

Output mode: files_with_matches


| File |
|------|
| `frontend\components\layout\Sidebar.tsx` |
| `frontend\components\salesOrders\SingleStepOrderForm.tsx` |
| `frontend\app\api\sales-orders\[id]\generate-delivery-note\route.ts` |
| `frontend\types\salesOrder.ts` |
| `frontend\lib\api\salesOrders.ts` |
| `frontend\lib\api\deliveryNotes.ts` |
| `frontend\app\api\sales-orders\[id]\route.ts` |
| `frontend\lib\utils\mapper.ts` |
| `frontend\app\api\sales-orders\[id]\permissions\route.ts` |
| `frontend\lib\hooks\useDeliveryNotes.ts` |
| `frontend\lib\hooks\useSalesOrders.ts` |
| `frontend\app\dashboard\sales-orders\[id]\edit\page.tsx` |
| `frontend\types\permissions.ts` |
| `frontend\types\deliveryNote.ts` |
| `frontend\lib\permissions\salesOrders.ts` |
| `frontend\lib\hooks\useSalesOrderPermissions.ts` |
| `frontend\prisma\schema.prisma` |


</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "\/invoices\/|factura" in "spisa-new/frontend" • 20 matches</summary>

Output mode: files_with_matches


| File |
|------|
| `frontend\components\layout\Sidebar.tsx` |
| `frontend\app\dashboard\page.tsx` |
| `frontend\components\invoices\InvoicesTable.tsx` |
| `frontend\components\salesOrders\SalesOrdersTable.tsx` |
| `frontend\app\layout.tsx` |
| `frontend\components\salesOrders\SingleStepOrderForm.tsx` |
| `frontend\lib\hooks\useSalesOrders.ts` |
| `frontend\app\dashboard\sales-orders\[id]\edit\page.tsx` |
| `frontend\app\api\sales-orders\[id]\route.ts` |
| `frontend\app\api\sales-orders\[id]\generate-invoice\route.ts` |
| `frontend\lib\permissions\salesOrders.ts` |
| `frontend\types\permissions.ts` |
| `frontend\lib\actions\sales-orders.ts` |
| `frontend\app\dashboard\invoices\[id]\page.tsx` |
| `frontend\app\dashboard\invoices\new\page.tsx` |
| `frontend\app\dashboard\invoices\page.tsx` |
| `frontend\app\dashboard\sales-orders\page.tsx` |
| `frontend\lib\api\invoices.ts` |
| `frontend\lib\hooks\useInvoices.ts` |
| `frontend\lib\actions\invoices.ts` |


</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Ya tengo la información necesaria:
- El `existingOrder` tiene propiedades `invoice` y `deliveryNote` que son objetos si existen o `null` si no existen.
- El botón "Generar Remito" solo se muestra cuando `!existingOrder?.deliveryNote` (línea 1113)
- Necesito agregar botones "Ver Remito" y "Ver Factura" cuando estos documentos existan

Ahora necesito ver si existen rutas para ver estos documentos. Hay archivos de página para facturas:
- `frontend\app\dashboard\invoices\[id]\page.tsx` - Probablemente una página para ver una factura específica
- Y posiblemente necesitemos crear una ruta similar para remitos

Déjame verificar las rutas que existen.</details></think>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
El usuario quiere que en la parte inferior de la pantalla "Editar Pedido", donde actualmente hay botones "Generar Remito" y "Guardar Cambios", se agreguen botones adicionales "Ver Remito" y "Ver Factura" cuando estos documentos ya estén generados.

Necesito:
1. Entender la estructura del código actual
2. Buscar dónde se renderiza esta sección de botones
3. Agregar lógica para mostrar "Ver Remito" y "Ver Factura" condicionalmente basado en si existen
4. Asegurarme de que estos botones tengan la funcionalidad adecuada

Ya tengo la información necesaria:
- El `existingOrder` tiene propiedades `invoice` y `deliveryNote` que son objetos si existen o `null` si no existen.
- El botón "Generar Remito" solo se muestra cuando `!existingOrder?.deliveryNote` (línea 1113)
- Necesito agregar botones "Ver Remito" y "Ver Factura" cuando estos documentos existan

Veo que existe:
- `/dashboard/invoices/[id]` - Ruta para ver una factura
- No parece haber una ruta para ver remitos

Necesito:
1. Crear una ruta para ver remitos (delivery notes)
2. Agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido

Déjame verificar si existe algo para remitos primero.</details></think>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "delivery-notes" in "spisa-new/frontend/app/dashboard" • 0 matches</summary>

Output mode: content


_No matches found_

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/app/dashboard/invoices/[id]/page.tsx</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. No existe una página para ver remitos (delivery notes) todavía
2. Existe una página para ver facturas en `/dashboard/invoices/[id]`
3. Necesito:
   - Crear una página para ver remitos
   - Agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido cuando estos documentos existan

El usuario quiere que aparezcan los botones "Ver Remito" y "Ver Factura" en la parte inferior donde están los botones "Generar Remito" y "Guardar Cambios". Estos botones deben aparecer solo cuando los documentos estén generados.

Déjame crear un plan de tareas y comenzar a implementar:

1. Crear la página de visualización de remito (delivery note)
2. Modificar el componente `SingleStepOrderForm` para agregar los botones "Ver Remito" y "Ver Factura"
3. Asegurarme de que los botones redirijan a las páginas correspondientes</details></think>

---

Ahora entiendo lo que necesitas. Voy a:

1. Crear una página para ver remitos (similar a la de facturas)
2. Agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición cuando estos documentos existan

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [-] Crear página de visualización de remito (delivery note)
- [ ] Agregar botones 'Ver Remito' y 'Ver Factura' en el formulario de edición de pedido
- [ ] Verificar que la navegación funcione correctamente

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/types/deliveryNote.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/lib/hooks/useDeliveryNotes.ts</summary>

</details>
</tool-use>

---

Perfecto, ahora voy a crear la página de visualización del remito y luego agregar los botones al formulario:

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **run_terminal_cmd** • Run command: cd "spisa-new/frontend/app/dashboard" && mkdir -p delivery-notes/[id]</summary>

```bash
cd "spisa-new/frontend/app/dashboard" && mkdir -p delivery-notes/[id]
```

```
$ cd "spisa-new/frontend/app/dashboard" &amp;&amp; mkdir -p delivery-notes/[id]
bash: cd: spisa-new/frontend/app/dashboard: No such file or directory
```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. No existe una página para ver remitos (delivery notes) todavía
2. Existe una página para ver facturas en `/dashboard/invoices/[id]`
3. Necesito:
   - Crear una página para ver remitos
   - Agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido cuando estos documentos existan

El usuario quiere que aparezcan los botones "Ver Remito" y "Ver Factura" en la parte inferior donde están los botones "Generar Remito" y "Guardar Cambios". Estos botones deben aparecer solo cuando los documentos estén generados.

Estoy en el workspace spisa-new. Déjame crear la estructura de directorios correctamente.</details></think>

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **run_terminal_cmd** • Run command: cd frontend/app/dashboard && mkdir -p "delivery-notes/[id]"</summary>

```bash
cd frontend/app/dashboard && mkdir -p "delivery-notes/[id]"
```

```
$ cd frontend/app/dashboard &amp;&amp; mkdir -p "delivery-notes/[id]"
```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. No existe una página para ver remitos (delivery notes) todavía
2. Existe una página para ver facturas en `/dashboard/invoices/[id]`
3. Necesito:
   - Crear una página para ver remitos
   - Agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido cuando estos documentos existan

El usuario quiere que aparezcan los botones "Ver Remito" y "Ver Factura" en la parte inferior donde están los botones "Generar Remito" y "Guardar Cambios". Estos botones deben aparecer solo cuando los documentos estén generados.

Ya creé la estructura de directorios. Ahora voy a crear la página de visualización de remitos basándome en la página de facturas.</details></think>

---

Ahora voy a crear la página para visualizar el remito:

---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** • Edit file: spisa-new/frontend/app/dashboard/delivery-notes/[id]/page.tsx</summary>

**Chunk 1**
Lines added: 159, lines removed: 1

```diff
@@ -1,1 +1,159 @@
- 
+ 'use client';
+ 
+ import { useParams, useRouter } from 'next/navigation';
+ import { ArrowLeft, Printer, Edit, FileText } from 'lucide-react';
+ import { Button } from '@/components/ui/button';
+ import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
+ import { useDeliveryNote, useDownloadDeliveryNotePdf } from '@/lib/hooks/useDeliveryNotes';
+ 
+ export default function DeliveryNoteDetailPage() {
+   const params = useParams();
+   const router = useRouter();
+   const deliveryNoteId = Number(params.id);
+   
+   const { data: deliveryNote, isLoading } = useDeliveryNote(deliveryNoteId);
+   const downloadPdfMutation = useDownloadDeliveryNotePdf();
+ 
+   if (isLoading) {
+     return (
+       &lt;div className="flex items-center justify-center h-96"&gt;
+         &lt;p className="text-muted-foreground"&gt;Cargando remito...&lt;/p&gt;
+       &lt;/div&gt;
+     );
+   }
+ 
+   if (!deliveryNote) {
+     return (
+       &lt;div className="flex flex-col items-center justify-center h-96 gap-4"&gt;
+         &lt;p className="text-muted-foreground"&gt;Remito no encontrado&lt;/p&gt;
+         &lt;Button onClick={() =&gt; router.push('/dashboard/sales-orders')}&gt;
+           &lt;ArrowLeft className="mr-2 h-4 w-4" /&gt;
+           Volver al listado
+         &lt;/Button&gt;
+       &lt;/div&gt;
+     );
+   }
+ 
+   const formatDate = (dateString: string) =&gt; {
+     return new Date(dateString).toLocaleDateString('es-AR');
+   };
+ 
+   const handleDownloadPdf = () =&gt; {
+     downloadPdfMutation.mutate(deliveryNoteId);
+   };
+ 
+   return (
+     &lt;div className="space-y-6"&gt;
+       {/* Header */}
+       &lt;div className="flex items-center justify-between"&gt;
+         &lt;div className="flex items-center gap-4"&gt;
+           &lt;Button variant="ghost" onClick={() =&gt; router.back()}&gt;
+             &lt;ArrowLeft className="h-4 w-4" /&gt;
+           &lt;/Button&gt;
+           &lt;div&gt;
+             &lt;h1 className="text-3xl font-bold"&gt;Remito {deliveryNote.deliveryNumber}&lt;/h1&gt;
+             &lt;p className="text-muted-foreground"&gt;
+               Fecha de Entrega: {formatDate(deliveryNote.deliveryDate)}
+             &lt;/p&gt;
+           &lt;/div&gt;
+         &lt;/div&gt;
+         &lt;div className="flex gap-2"&gt;
+           &lt;Button variant="outline" onClick={handleDownloadPdf} disabled={downloadPdfMutation.isPending}&gt;
+             &lt;Printer className="mr-2 h-4 w-4" /&gt;
+             {downloadPdfMutation.isPending ? 'Descargando...' : 'Descargar PDF'}
+           &lt;/Button&gt;
+         &lt;/div&gt;
+       &lt;/div&gt;
+ 
+       &lt;div className="grid gap-6 md:grid-cols-2"&gt;
+         {/* Client Information */}
+         &lt;Card&gt;
+           &lt;CardHeader&gt;
+             &lt;CardTitle&gt;Información del Cliente&lt;/CardTitle&gt;
+           &lt;/CardHeader&gt;
+           &lt;CardContent className="space-y-2"&gt;
+             &lt;div&gt;
+               &lt;p className="text-sm text-muted-foreground"&gt;Razón Social&lt;/p&gt;
+               &lt;p className="font-medium"&gt;{deliveryNote.clientBusinessName}&lt;/p&gt;
+             &lt;/div&gt;
+           &lt;/CardContent&gt;
+         &lt;/Card&gt;
+ 
+         {/* Delivery Note Information */}
+         &lt;Card&gt;
+           &lt;CardHeader&gt;
+             &lt;CardTitle&gt;Información del Remito&lt;/CardTitle&gt;
+           &lt;/CardHeader&gt;
+           &lt;CardContent className="space-y-2"&gt;
+             &lt;div&gt;
+               &lt;p className="text-sm text-muted-foreground"&gt;Pedido N°&lt;/p&gt;
+               &lt;p className="font-medium"&gt;
+                 &lt;Button
+                   variant="link"
+                   className="p-0 h-auto"
+                   onClick={() =&gt; router.push(&#96;/dashboard/sales-orders/${deliveryNote.salesOrderId}/edit&#96;)}
+                 &gt;
+                   {deliveryNote.salesOrderNumber}
+                 &lt;/Button&gt;
+               &lt;/p&gt;
+             &lt;/div&gt;
+             {deliveryNote.transporterName &amp;&amp; (
+               &lt;div&gt;
+                 &lt;p className="text-sm text-muted-foreground"&gt;Transportista&lt;/p&gt;
+                 &lt;p className="font-medium"&gt;{deliveryNote.transporterName}&lt;/p&gt;
+               &lt;/div&gt;
+             )}
+             {deliveryNote.weightKg &amp;&amp; (
+               &lt;div&gt;
+                 &lt;p className="text-sm text-muted-foreground"&gt;Peso (kg)&lt;/p&gt;
+                 &lt;p className="font-medium"&gt;{deliveryNote.weightKg.toFixed(2)} kg&lt;/p&gt;
+               &lt;/div&gt;
+             )}
+             {deliveryNote.packagesCount &amp;&amp; (
+               &lt;div&gt;
+                 &lt;p className="text-sm text-muted-foreground"&gt;Cantidad de Bultos&lt;/p&gt;
+                 &lt;p className="font-medium"&gt;{deliveryNote.packagesCount}&lt;/p&gt;
+               &lt;/div&gt;
+             )}
+             {deliveryNote.declaredValue &amp;&amp; (
+               &lt;div&gt;
+                 &lt;p className="text-sm text-muted-foreground"&gt;Valor Declarado&lt;/p&gt;
+                 &lt;p className="font-medium"&gt;
+                   {new Intl.NumberFormat('es-AR', {
+                     style: 'currency',
+                     currency: 'ARS',
+                     minimumFractionDigits: 2,
+                   }).format(deliveryNote.declaredValue)}
+                 &lt;/p&gt;
+               &lt;/div&gt;
+             )}
+             {deliveryNote.notes &amp;&amp; (
+               &lt;div&gt;
+                 &lt;p className="text-sm text-muted-foreground"&gt;Observaciones&lt;/p&gt;
+                 &lt;p className="font-medium"&gt;{deliveryNote.notes}&lt;/p&gt;
+               &lt;/div&gt;
+             )}
+           &lt;/CardContent&gt;
+         &lt;/Card&gt;
+       &lt;/div&gt;
+ 
+       {/* Metadata */}
+       &lt;Card&gt;
+         &lt;CardHeader&gt;
+           &lt;CardTitle&gt;Información de Auditoría&lt;/CardTitle&gt;
+         &lt;/CardHeader&gt;
+         &lt;CardContent className="space-y-2"&gt;
+           &lt;div&gt;
+             &lt;p className="text-sm text-muted-foreground"&gt;Fecha de Creación&lt;/p&gt;
+             &lt;p className="font-medium"&gt;{formatDate(deliveryNote.createdAt)}&lt;/p&gt;
+           &lt;/div&gt;
+           &lt;div&gt;
+             &lt;p className="text-sm text-muted-foreground"&gt;Última Actualización&lt;/p&gt;
+             &lt;p className="font-medium"&gt;{formatDate(deliveryNote.updatedAt)}&lt;/p&gt;
+           &lt;/div&gt;
+         &lt;/CardContent&gt;
+       &lt;/Card&gt;
+     &lt;/div&gt;
+   );
+ }
+ 
```

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ahora necesito agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido - TODO 2
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

Ahora voy a modificar el componente `SingleStepOrderForm` para agregar los botones "Ver Remito" y "Ver Factura" cuando estos documentos existan.

La estructura actual es:
- Línea 1113-1122: Botón "Generar Remito" (solo si no existe el remito)
- Línea 1123-1132: Botón "Generar Factura"
- Línea 1133-1144: Botón "Guardar Cambios"

Necesito agregar:
- Botón "Ver Remito" cuando `existingOrder?.deliveryNote` existe
- Botón "Ver Factura" cuando `existingOrder?.invoice` existe

Estos botones deben ir después de los botones de "Generar..." pero antes del botón "Guardar Cambios".</details></think>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Crear página de visualización de remito (delivery note)
- [-] Agregar botones 'Ver Remito' y 'Ver Factura' en el formulario de edición de pedido
- [ ] Verificar que la navegación funcione correctamente

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ahora necesito agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido - TODO 2
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

Ahora voy a modificar el componente `SingleStepOrderForm` para agregar los botones "Ver Remito" y "Ver Factura" cuando estos documentos existan.

La estructura actual es:
- Línea 1113-1122: Botón "Generar Remito" (solo si no existe el remito)
- Línea 1123-1132: Botón "Generar Factura"
- Línea 1133-1144: Botón "Guardar Cambios"

Necesito agregar:
- Botón "Ver Remito" cuando `existingOrder?.deliveryNote` existe
- Botón "Ver Factura" cuando `existingOrder?.invoice` existe

Estos botones deben ir después de los botones de "Generar..." pero antes del botón "Guardar Cambios".

Déjame leer la sección de los botones completa para hacer los cambios correctamente.</details></think>

---

Ahora voy a agregar los botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido:

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ahora necesito agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido - TODO 2
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

Ahora voy a modificar el componente `SingleStepOrderForm` para agregar los botones "Ver Remito" y "Ver Factura" cuando estos documentos existan.

La estructura actual es:
- Línea 1113-1122: Botón "Generar Remito" (solo si no existe el remito)
- Línea 1123-1132: Botón "Generar Factura"
- Línea 1133-1144: Botón "Guardar Cambios"

Necesito agregar:
- Botón "Ver Remito" cuando `existingOrder?.deliveryNote` existe
- Botón "Ver Factura" cuando `existingOrder?.invoice` existe

Estos botones deben ir después de los botones de "Generar..." pero antes del botón "Guardar Cambios".

Déjame leer la sección de los botones completa para hacer los cambios correctamente.</details></think>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -13,5 +13,5 @@
  import { useQuickCartTabs, QuickCartItem } from '@/lib/hooks/useQuickCartTabs';
  import { Alert, AlertDescription } from '@/components/ui/alert';
- import { ShoppingCart, User, X, Trash2, Pencil, Search, Plus, XCircle, FileText, AlertTriangle, Truck } from 'lucide-react';
+ import { ShoppingCart, User, X, Trash2, Pencil, Search, Plus, XCircle, FileText, AlertTriangle, Truck, Eye } from 'lucide-react';
  import { useArticles } from '@/lib/hooks/useArticles';
  import type { Article } from '@/types/article';
```

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ahora necesito agregar botones "Ver Remito" y "Ver Factura" en el formulario de edición de pedido - TODO 2
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

Ahora voy a modificar el componente `SingleStepOrderForm` para agregar los botones "Ver Remito" y "Ver Factura" cuando estos documentos existan.

La estructura actual es:
- Línea 1113-1122: Botón "Generar Remito" (solo si no existe el remito)
- Línea 1123-1132: Botón "Generar Factura"
- Línea 1133-1144: Botón "Guardar Cambios"

Necesito agregar:
- Botón "Ver Remito" cuando `existingOrder?.deliveryNote` existe
- Botón "Ver Factura" cuando `existingOrder?.invoice` existe

Estos botones deben ir después de los botones de "Generar..." pero antes del botón "Guardar Cambios".

Ya agregué el icono Eye. Ahora voy a modificar la sección de botones.</details></think>

---

Ahora voy a agregar los botones "Ver Remito" y "Ver Factura" en la sección de botones:

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

**Chunk 1**
Lines added: 9, lines removed: undefined

```diff
@@ -1121,4 +1121,13 @@
                  &lt;/Button&gt;
                )}
+               {existingOrder?.deliveryNote &amp;&amp; (
+                 &lt;Button
+                   variant="outline"
+                   onClick={() =&gt; router.push(&#96;/dashboard/delivery-notes/${existingOrder.deliveryNote?.id}&#96;)}
+                 &gt;
+                   &lt;Eye className="mr-2 h-4 w-4" /&gt;
+                   Ver Remito
+                 &lt;/Button&gt;
+               )}
                {permissions.canCreateInvoice &amp;&amp; (
                  &lt;Button
```

**Chunk 2**
Lines added: 9, lines removed: undefined

```diff
@@ -1131,4 +1140,13 @@
                  &lt;/Button&gt;
                )}
+               {existingOrder?.invoice &amp;&amp; (
+                 &lt;Button
+                   variant="outline"
+                   onClick={() =&gt; router.push(&#96;/dashboard/invoices/${existingOrder.invoice?.id}&#96;)}
+                 &gt;
+                   &lt;Eye className="mr-2 h-4 w-4" /&gt;
+                   Ver Factura
+                 &lt;/Button&gt;
+               )}
                {permissions.canSave &amp;&amp; (
                  &lt;Button
```

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ya agregué los botones "Ver Remito" y "Ver Factura" - TODO 2 completado
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

Ahora debo verificar si hay errores de linting y luego actualizar los TODOs.</details></think>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Crear página de visualización de remito (delivery note)
- [x] Agregar botones 'Ver Remito' y 'Ver Factura' en el formulario de edición de pedido
- [-] Verificar que la navegación funcione correctamente

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 2 files</summary>
      
Lint paths:

- `spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx`
- `spisa-new/frontend/app/dashboard/delivery-notes/[id]/page.tsx`

Lint results


**No lint errors found**
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ahora tengo una mejor idea de lo que necesito hacer:

1. Ya creé la página de visualización de remitos - TODO 1 completado
2. Ya agregué los botones "Ver Remito" y "Ver Factura" - TODO 2 completado
3. Y finalmente verificar que la navegación funcione correctamente - TODO 3

No hay errores de linting. Ahora voy a verificar que la navegación funcione correctamente. Para esto, necesito ver si hay un pedido con remito o factura generada y navegar a la página de edición para verificar que los botones aparezcan correctamente.

Primero, déjame verificar si existe alguna ruta para listar remitos o facturas, o si necesito verificar desde el backend. También puedo verificar si existe alguna API para obtener los pedidos con sus remitos/facturas asociados.</details></think>

---

Perfecto, no hay errores de linting. Ahora voy a verificar que todo funcione correctamente revisando si hay alguna configuración adicional necesaria para la API de remitos:

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/frontend/lib/api/deliveryNotes.ts</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Bueno, ya tengo todo configurado. La API de remitos ya existe y está correctamente configurada. Ahora voy a verificar que la implementación esté completa revisando el BUTTON_STATUSES.md para entender mejor las reglas de negocio sobre cuándo deben mostrarse estos botones.

Pero espera, el usuario me dijo que los botones "Ver Remito" y "Ver Factura" deben aparecer si estos documentos están generados. Ya implementé eso:

- `existingOrder?.deliveryNote` - Muestra "Ver Remito" si existe el remito
- `existingOrder?.invoice` - Muestra "Ver Factura" si existe la factura

Sin embargo, mirando la imagen del usuario nuevamente, veo que la estructura es:
- Izquierda: botones de acciones negativas (Cancelar, Eliminar)
- Derecha: botones de acciones principales (Generar Remito, Generar Factura, Guardar Cambios)

Y según el requerimiento del usuario, los botones "Ver Remito" y "Ver Factura" deben aparecer cuando estos documentos YA estén generados, presumiblemente en lugar de o además de los botones "Generar...".

Mi implementación actual:
- Muestra "Generar Remito" SOLO si no existe el remito
- Muestra "Ver Remito" SI existe el remito
- Muestra "Ver Factura" SI existe la factura (pero también muestra "Generar Factura")

Esto parece correcto, pero déjame verificar si hay alguna lógica especial con las facturas. Revisando el código, veo que hay un permiso `canCreateInvoice` que controla si se muestra el botón "Generar Factura". 

Necesito investigar más a fondo la lógica de visualización de botones para garantizar que se muestren correctamente según las reglas de negocio.</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: spisa-new/BUTTON_STATUSES.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Excelente! Ahora veo más claro el contexto. Según el documento BUTTON_STATUSES.md:

**Estado 3: Pedido Almacenado Con Factura Sin Remito**
- Botones: Visualizar Factura, Generar Remito

**Estado 4: Pedido Almacenado Sin Factura Con Remito**
- Botones: Generar Factura, Visualizar Remito

**Estado 5: Pedido Almacenado Con Factura Con Remito**
- Botones: Visualizar Factura, Visualizar Remito

Sin embargo, mi implementación actual muestra AMBOS botones:
- "Generar Factura" Y "Ver Factura" al mismo tiempo si existe la factura

Esto no es correcto según la documentación. Debería ser:
- Si NO existe factura → Mostrar "Generar Factura"
- Si existe factura → Mostrar "Ver Factura"

Lo mismo para el remito:
- Si NO existe remito → Mostrar "Generar Remito"
- Si existe remito → Mostrar "Ver Remito"

Déjame corregir esto.</details></think>

---

Veo que necesito ajustar la lógica. Según la documentación, cuando existe una factura o remito, debe mostrarse el botón "Ver" en lugar del botón "Generar", no ambos al mismo tiempo. Déjame corregir esto:

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -1130,5 +1130,5 @@
                  &lt;/Button&gt;
                )}
-               {permissions.canCreateInvoice &amp;&amp; (
+               {permissions.canCreateInvoice &amp;&amp; !existingOrder?.invoice &amp;&amp; (
                  &lt;Button
                    variant="outline"
```

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
Perfecto! Ahora la lógica es correcta:
- Si NO existe remito Y el usuario tiene permiso → Mostrar "Generar Remito"
- Si existe remito → Mostrar "Ver Remito"
- Si NO existe factura Y el usuario tiene permiso → Mostrar "Generar Factura"
- Si existe factura → Mostrar "Ver Factura"

Esto está alineado con la documentación del sistema legacy. Ahora voy a verificar que no haya errores de linting y luego marcar el TODO 3 como completado.</details></think>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `spisa-new/frontend/components/salesOrders/SingleStepOrderForm.tsx`

Lint results


**No lint errors found**
</details>
</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Crear página de visualización de remito (delivery note)
- [x] Agregar botones 'Ver Remito' y 'Ver Factura' en el formulario de edición de pedido
- [x] Verificar que la navegación funcione correctamente

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
Excelente! Ahora veo más claro el contexto. Según el documento BUTTON_STATUSES.md:

**Estado 3: Pedido Almacenado Con Factura Sin Remito**
- Botones: Visualizar Factura, Generar Remito

**Estado 4: Pedido Almacenado Sin Factura Con Remito**
- Botones: Generar Factura, Visualizar Remito

**Estado 5: Pedido Almacenado Con Factura Con Remito**
- Botones: Visualizar Factura, Visualizar Remito

Ya corregí la implementación para que:
- Si NO existe factura Y tiene permiso → Mostrar "Generar Factura"
- Si existe factura → Mostrar "Ver Factura"

Lo mismo para el remito:
- Si NO existe remito Y tiene permiso → Mostrar "Generar Remito"
- Si existe remito → Mostrar "Ver Remito"

No hay errores de linting y todos los TODOs están completados. Ahora voy a crear un resumen de los cambios realizados.</details></think>

---

Perfecto! He completado la implementación. Los cambios realizados son:

## Resumen de cambios

1. **Creada página de visualización de remito** (`delivery-notes/[id]/page.tsx`):
   - Muestra información del remito, cliente, y datos del pedido asociado
   - Incluye botón para descargar PDF del remito
   - Tiene navegación hacia el pedido asociado

2. **Modificado el formulario de edición de pedido** (`SingleStepOrderForm.tsx`):
   - Agregado icono `Eye` para los botones de visualización
   - Lógica de botones ahora funciona según reglas de negocio:
     - **Sin remito**: Muestra "Generar Remito" (si tiene permiso)
     - **Con remito**: Muestra "Ver Remito"
     - **Sin factura**: Muestra "Generar Factura" (si tiene permiso)
     - **Con factura**: Muestra "Ver Factura"

Los botones aparecen en la parte inferior derecha, junto a "Guardar Cambios", tal como solicitaste. La lógica asegura que solo se muestre el botón apropiado según el estado del pedido, evitando confusión al usuario.

---

